<h2 id="exporting">Exporting</h2>
<p>By default when you enable distributed tracing in your application you do <em>NOT</em> automatically enable exporting of those traces to a backend system. Currently, Steeltoe supports exporting traces to a backend Zipkin server.</p>
<p>To enable exporting you will need to do the following:</p>
<ul>
<li>Add appropriate NuGet package reference to your project.</li>
<li>Configure the settings the exporter will use during export.</li>
<li>Add and Use the exporter service in the application</li>
</ul>
<h3 id="add-nuget-references">Add NuGet References</h3>
<p>All of the exporters can be found in the <code>Steeltoe.Management.ExporterBase</code> and in <code>Steeltoe.Management.OpenCensus</code>.</p>
<p>To use an exporter in a ASP.NET Core application, then add the following <code>PackageReference</code> to your <code>.csproj</code> file.</p>
<pre><code class="language-xml">&lt;ItemGroup&gt;
...
    &lt;PackageReference Include=&quot;Steeltoe.Management.ExporterCore&quot; Version= &quot;2.1.0&quot;/&gt;
...
&lt;/ItemGroup&gt;
</code></pre>
<p>or</p>
<pre><code class="language-powershell">PM&gt;Install-Package  Steeltoe.Management.ExporterCore -Version 2.1.0
</code></pre>
<h3 id="zipkin-server">Zipkin Server</h3>
<p>Zipkin is a popular distributed tracing system which has been around for several years. It is composed of client libraries for instrumenting application code and a backend server for collecting and viewing the collected data. For more information on Zipkin we encourage you to review the <a href="https://zipkin.io/">documentation</a>.  Check out the <a href="https://zipkin.io/pages/quickstart">Quickstart</a> guide for details on how to set up a server.</p>
<p>Steeltoe provides an exporter that will send all captured traces to a Zipkin server.  The following sections outline how to enable the exporter in your application.</p>
<h4 id="configure-settings">Configure Settings</h4>
<p>The following table describes the settings that you can apply to the exporter:</p>
<table class="table">
<thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>endpoint</td>
<td>the uri used to POST traces</td>
<td><code>http://localhost:9411/api/v2/spans</code></td>
</tr>
<tr>
<td>validateCertificates</td>
<td>validate SSL certificates received from exporter service</td>
<td>true</td>
</tr>
<tr>
<td>timeoutSeconds</td>
<td>timeout used in seconds for each POST request</td>
<td>3</td>
</tr>
<tr>
<td>serviceName</td>
<td>app name used in log messages</td>
<td>null</td>
</tr>
<tr>
<td>useShortTraceIds</td>
<td>truncate the ids to 8 bytes instead of 16, use for backwards compatibility with Spring Sleuth, PCF Metrics, etc.</td>
<td>true</td>
</tr>
</tbody>
</table>
<h4 id="add-and-use-zipkin-exporter">Add and Use Zipkin Exporter</h4>
<p>There are two steps needed to use the Zipkin exporter:</p>
<ol>
<li>Add the exporter to the service container. Use the <code>AddZipkinExporter()</code> extension method from <a href="https://github.com/SteeltoeOSS/Management/blob/master/src/Steeltoe.Management.ExporterCore/Tracing/Zipkin/ZipkinExporterServiceCollectionExtensions.cs">ZipkinExporterServiceCollectionExtensions</a>.</li>
<li>Start the exporter background thread. Use the <code>UseTracingExporter()</code> extension method from <a href="https://github.com/SteeltoeOSS/Management/blob/master/src/Steeltoe.Management.ExporterCore/Tracing/Zipkin/ZipkinExporterApplicationBuilderExtensions.cs">ZipkinExporterApplicationBuilderExtensions</a>.</li>
</ol>
<pre><code class="language-csharp">public class Startup
{
    public Startup(IConfiguration configuration)
    {
        Configuration = configuration;
    }
    public void ConfigureServices(IServiceCollection services)
    {
        // Add Distributed tracing
        services.AddDistributedTracing(Configuration);

        // Export traces to Zipkin
        services.AddZipkinExporter(Configuration);
        ...
    }
    public void Configure(IApplicationBuilder app)
    {
        app.UseStaticFiles();
        app.UseMvc();

        // Start up trace exporter
        app.UseTracingExporter();
    }
}
</code></pre>
